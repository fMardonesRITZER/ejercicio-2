(window.agentWebpackJsonp=window.agentWebpackJsonp||[]).push([[14],{509:function(t,e,n){"use strict";var a=n(2);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n(138),a=a(n(198)),n=n(594),n=(0,o.connect)(function(t){return t})((0,a.default)(n.Launcher,"Launcher"));e.default=n},594:function(t,e,n){"use strict";var a=n(2);Object.defineProperty(e,"__esModule",{value:!0}),e.Launcher=void 0;var r=a(n(92)),i=a(n(93)),c=a(n(56)),s=a(n(57)),l=a(n(199)),u=a(n(136)),o=a(n(137)),d=a(n(91)),g=a(n(23)),p=a(n(18)),f=n(35),h=n(13),m=n(75),w=n(15),v=n(19),E=n(139),_=n(201),y=a(n(94)),b=a(n(17)),C=n(67),S=n(595);function A(n){var a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,d.default)(n);return e=a?(t=(0,d.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,o.default)(this,e)}}var W="".concat(h.M5QkGdQ,"/cta_help.png"),T="".concat(h.M5QkGdQ,"/cta_chat.png"),K="".concat(h.M5QkGdQ,"/cta_icon.png"),I="".concat(h.M5QkGdQ,"/cta_help_b.png"),M="".concat(h.M5QkGdQ,"/cta_chat_b.png"),k="".concat(h.M5QkGdQ,"/cta_icon_b.png"),Y=null,h=function(t){(0,u.default)(o,t);var e,n,a=A(o);function o(t){return(0,c.default)(this,o),(t=a.call(this,t)).handleToggle=t.handleToggle.bind((0,l.default)(t)),t.handleTouchMove=t.handleTouchMove.bind((0,l.default)(t)),t.addAnimatedImageSupport=t.addAnimatedImageSupport.bind((0,l.default)(t)),t.getAnimatedImageClass=t.getAnimatedImageClass.bind((0,l.default)(t)),t.state={dimensions:{height:""}},t}return(0,s.default)(o,[{key:"isPNG",value:function(t){return"png"===(("string"==typeof t?t.split(".").pop():null)||t)}},{key:"hasAPNGSupport",value:function(){return!(m.DEVICE__EDGE||m.DEVICE__IE11||navigator.userAgent.match(/MSIE ([0-9]+)\./)&&10<=parseInt(RegExp.$1)||navigator.userAgent.match(/Chrome\/([0-9]+)\./)&&parseInt(RegExp.$1)<=58)}},{key:"addAnimatedImageSupport",value:function(){(0,b.default.searchInsideShadowRoot)(".aivochat-animated-image")[0].forEach(function(t){Y.animateImage(t)})}},{key:"getAnimatedImageClass",value:function(t){var e=this.hasAPNGSupport()?"":"aivochat-animated-image";return e=this.isPNG(t||"")?e:""}},{key:"handleToggle",value:(n=(0,i.default)(r.default.mark(function t(e){var n,a,o,i,c,s;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),i=this.props,n=i.dispatch,a=i.agentConfig,o=i.agentMessages,c=a.chatWindow.launcher.position||"right_bottom",i="right"===c.split("_")[0]?"right":"left",a._windowOpened){t.next=16;break}return t.next=7,(0,_.importAgentAppChunk)();case 7:return s=t.sent,a.chatWindow.staticPosition||y.default.dragWindow(i),t.next=11,n((0,f.setAppConfig)({AgentApp:s}));case 11:(s=c=null,v.isSmallWindow)()&&null!==a.ctaMobile?(c=a.ctaMobile.ctaType,s=!!a.ctaMobile.complements):(0,v.isSmallWindow)()||null===a.ctaWeb||(c=a.ctaWeb.ctaType,s=!!a.ctaWeb.complements),(0,v.interactionWithUser)(o)?window[w.KEY__SDK]._onOpenWindow&&window[w.KEY__SDK]._onOpenWindow():(s=[{action:"event_id",param:a.app.id},{action:"event_type",param:"firstInteraction-chat"},{action:"cta_type",param:c},{action:"activated_button",param:s},{action:"event",param:"open_cta"}],(0,C.setEventAnalytics)(a.user.id,a.app.id,window.navigator.userAgent,s),window[w.KEY__SDK]._onFirstInteraction&&window[w.KEY__SDK]._onFirstInteraction("open_cta")),n((0,f.openWindow)());case 16:case"end":return t.stop()}},t,this)})),function(t){return n.apply(this,arguments)})},{key:"handleTouchMove",value:function(t){var e,n,a,o,i=b.default.searchInsideShadowRoot(".agent-launcher")[0],c=i.classList.value;(0,v.isSmallWindow)()&&-1!==(-1!==c.indexOf("aivochat-launcher")||-1!==c.indexOf("agent-launcher")||c.indexOf("custom-html-css"))&&(t.preventDefault(),a=window.scrollY||window.pageYOffset,o=window.scrollX||window.pageXOffset,e=i.offsetWidth||i.clientWidth,n=i.offsetHeight||i.clientHeight,c=t.changedTouches[0].pageX-e/2,t=t.changedTouches[0].pageY-n/2,a=window.outerHeight-t-n+a,o=c-o,i.style.top="auto",i.style.right="auto",(a=a>window.outerHeight-n?window.outerHeight-n:a)<0&&(a=0),(o=o>window.outerWidth-e?window.outerWidth-e:o)<0&&(o=0),i.style.bottom="".concat(a,"px"),i.style.left="".concat(o,"px"))}},{key:"importAPNG",value:(e=(0,i.default)(r.default.mark(function t(){return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,_.importAPNGChunk)();case 2:Y=t.sent,this.addAnimatedImageSupport();case 4:case"end":return t.stop()}},t,this)})),function(){return e.apply(this,arguments)})},{key:"componentDidMount",value:function(){var e=this,n=b.default.searchInsideShadowRoot(".agent-launcher")[0],t=this.props,a=t.dispatch,o=t.agentConfig,i=t.agentMessages,c=o.chatWindow.launcher,s=c.type,t=c.mobile,c=b.default.searchInsideShadowRoot,r=null;(0,v.isSmallWindow)()&&null!==o.ctaMobile?r=o.ctaMobile.ctaType:(0,v.isSmallWindow)()||null===o.ctaWeb||(r=o.ctaWeb.ctaType),n&&(n.addEventListener?n.addEventListener("touchmove",this.handleTouchMove):n.attachEvent("touchmove",this.handleTouchMove),this.hasAPNGSupport()||this.importAPNG()),(4===s&&!(0,v.isSmallWindow)()||(0,v.isSmallWindow)()&&4===t.type)&&setTimeout(function(){var t=(0,v.getHeightParentOrChild)(n);e.setState({dimensions:{height:t+30}})},1e3),c(".agent-launcher").length&&c(".agent-launcher")[0].addEventListener("click",function(){var t;(0,v.interactionWithUser)(i)?window[w.KEY__SDK]._onOpenWindow&&window[w.KEY__SDK]._onOpenWindow():(t=[{action:"event_id",param:o.app.id},{action:"event_type",param:"firstInteraction-chat"},{action:"cta_type",param:r},{action:"event",param:"open_cta"}],(0,C.setEventAnalytics)(o.user.id,o.app.id,window.navigator.userAgent,t),window[w.KEY__SDK]._onFirstInteraction&&window[w.KEY__SDK]._onFirstInteraction("open_cta")),a((0,f.openWindow)())});c=window.document.querySelector(".agent-launcher");c&&c.addEventListener("click",function(){var t;(0,v.interactionWithUser)(i)?window[w.KEY__SDK]._onOpenWindow&&window[w.KEY__SDK]._onOpenWindow():(t=[{action:"event_id",param:o.app.id},{action:"event_type",param:"firstInteraction-chat"},{action:"cta_type",param:r},{action:"event",param:"open_cta"}],(0,C.setEventAnalytics)(o.user.id,o.app.id,window.navigator.userAgent,t),window[w.KEY__SDK]._onFirstInteraction&&window[w.KEY__SDK]._onFirstInteraction("open_cta")),a((0,f.openWindow)())})}},{key:"getLauncher",value:function(){var t=this.props.agentConfig.chatWindow.launcher,e=t;return(0,v.isSmallWindow)()&&t.mobile?e=t.mobile:!(0,v.isSmallWindow)()&&t.web&&(e=t.web),e.enabled=t.enabled,e}},{key:"render",value:function(){var a=this,s=this,t=this.props,r=t.agentConfig,l=t.agentMessages,e=r.chatWindow,o=e.launcher,u=e.staticPosition,d=e.colors,n=r._windowOpened,t=r.__launcherHidden,e=r.chatWindow.launcher.enabled,p=!n&&e&&!t,i=b.default.searchInsideShadowRoot,c=b.default.removeElement,f=b.default.createElement,h=function(t,e,n){n=(0,v.onLauncherLoad)(t,e,n);a.setState({dimensions:{height:n}})},m=function(t){var e=s.getAnimatedImageClass(o.image),n=s.getLauncher();switch(t||n.type){case 2:case 3:return g.default.createElement("img",{crossOrigin:"anonymous",className:e,src:n.image});case 4:return c("#custom_launcher_styles"),n.css&&i()[0].appendChild(f("style",{nonce:w.KEY__NONCE,id:"custom_launcher_styles",innerHTML:"".concat(n.css)})),g.default.createElement("div",{dangerouslySetInnerHTML:{__html:n.html.replace(/(\\")/gm,'"')}});default:return _(t||n.type)}},_=function(t){var e="",n=(0,E.contrast)(d[0]),a=r.ctaWeb||null,o=r.ctaWeb?r.ctaMobile:null;switch(t){case 1:e=n?W:I;break;case 5:e=n?T:M;break;case 6:e=n?K:k}return a.showNotification&&!(0,v.isSmallWindow)()||o.showNotification&&(0,v.isSmallWindow)()?g.default.createElement("div",{className:"aivochat-launcher__notification"},g.default.createElement("div",{className:"aivochat-launcher__notification-icon"},g.default.createElement("p",null,"1")),g.default.createElement("div",{className:"aivochat-launcher__notification-image",style:{backgroundImage:"url(".concat(e,")")}})):g.default.createElement("div",{className:"aivochat-launcher__notification-image",style:{backgroundImage:"url(".concat(e,")")}})};return g.default.createElement("div",null,function(){var t,i=s.getLauncher(),e=r.chatWindow.launcher.position;(0,v.isSmallWindow)()&&r.ctaMobile?t=r.ctaMobile:!(0,v.isSmallWindow)()&&r.ctaWeb&&(t=r.ctaWeb);function n(t){var e=(0,v.getPositionClass)(i.position||"right_bottom"),n=u?w.KEY__STATIC_POSITION:"",a="".concat(p?w.KEY__ELEMENT_SHOW:w.KEY__ELEMENT_HIDE),o="".concat(w.KEY__LAUNCHER," ").concat(e," ").concat(n," ").concat(a);switch(t||i.type){case 1:case 5:case 6:return"".concat(o," custom-background");case 2:return"".concat(o," ").concat(w.KEY__LAUNCHER_TYPE_WITH_IMAGE," custom-background");case 3:return"".concat(o," ").concat(w.KEY__LAUNCHER_TYPE_ONLY_IMAGE);case 4:return"".concat(e," ").concat(a," ").concat(w.KEY__LAUNCHER_TYPE_CUSTOM)}}var a=e;if(!i.enabled)return null;(0,v.isSmallWindow)()&&(a=r.chatWindow.launcher.mobile.position);var o=s.state.dimensions,c=s.props.dispatch;switch(i.type){case 3:return g.default.createElement("div",null,g.default.createElement("div",{id:"".concat(w.KEY__LAUNCHER),className:"".concat(n()),onClick:s.handleToggle,onLoad:function(t){return h(t.target.height,i.type,a)}},m()),g.default.createElement(S.CTAButtons,{dispatch:c,dimensions:o,colors:d,classPosition:a,ctaButtonsData:t,agentConfig:r,agentMessages:l}));case 4:return g.default.createElement("div",null,g.default.createElement("div",{id:"".concat(w.KEY__LAUNCHER),className:"".concat(n()),onLoad:function(t){return h(t.target.height,i.type,a)}},m()),g.default.createElement(S.CTAButtons,{dispatch:c,dimensions:o,colors:d,classPosition:a,ctaButtonsData:t,agentConfig:r,agentMessages:l}));default:return g.default.createElement("div",null,g.default.createElement("div",{id:w.KEY__LAUNCHER,className:n(),onClick:s.handleToggle},m()),g.default.createElement(S.CTAButtons,{dispatch:c,dimensions:{height:(0,v.onLauncherLoad)(w.KEY__HEIGHT_CTA_TYPE_GIF,i.type,a)},colors:d,classPosition:a,ctaButtonsData:t,agentConfig:r,agentMessages:l}))}}())}}]),o}(g.default.Component);(e.Launcher=h).propTypes={agentConfig:p.default.object,dispatch:p.default.func,agentMessages:p.default.array}},595:function(t,e,n){"use strict";var a=n(2);Object.defineProperty(e,"__esModule",{value:!0}),e.CTAButtons=void 0;var o=a(n(56)),i=a(n(57)),c=a(n(199)),s=a(n(136)),r=a(n(137)),l=a(n(91)),u=a(n(12)),p=a(n(23)),d=n(35),f=a(n(18)),h=a(n(17)),m=n(19),_=n(15),g=n(67);function w(n){var a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,l.default)(n);return e=a?(t=(0,l.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,r.default)(this,e)}}n=function(t){(0,s.default)(n,t);var e=w(n);function n(t){var l;return(0,o.default)(this,n),l=e.call(this,t),(0,u.default)((0,c.default)(l),"handleCloseCTAButtons",function(t,e,n,a){t.preventDefault();a=[{action:"event_id",param:n.id},{action:"event_type",param:"close_cta_buttons"},{action:"cta_type",param:n.ctaType},{action:"activated_buttons",param:null!==a},{action:"event",param:"close_cta_buttons"}];(0,g.setEventAnalytics)(e.user.id,e.app.id,window.navigator.userAgent,a),window[_.KEY__SDK]._onCloseCtaButtons&&window[_.KEY__SDK]._onCloseCtaButtons(),l.props.dispatch((0,d.setConfig)({_showCTAButtons:!1})),l.setState({closedComponent:!0})}),(0,u.default)((0,c.default)(l),"calculateMargin",function(t){switch(t){case"right_bottom":case"center_bottom":case"left_bottom":return"bottom";default:return"top"}}),(0,u.default)((0,c.default)(l),"handleSendButtonCTA",function(t,e,n,a,o,i,c){t.preventDefault();var s=n.app,r=h.default.getUsers(),t=l.props.agentMessages,r=r[0],a=[{action:"event_id",param:i.id},{action:"event_type",param:"firstInteraction-chat"},{action:"cta_type",param:i.ctaType},{action:"activated_button",param:null!==c},{action:"event",param:"click_send_button"},{action:"event_value",param:o},{action:"group",param:a}];(0,m.interactionWithUser)(t)||((0,g.setEventAnalytics)(n.user.id,n.app.id,window.navigator.userAgent,a),window[_.KEY__SDK]._onFirstInteraction&&window[_.KEY__SDK]._onFirstInteraction("click_send_button")),l.props.dispatch((0,d.setConfig)({_showCTAButtons:!1})),l.setState({closedComponent:!0}),e((0,d.openWindow)()),e((0,d.sendMessage)(o,r,s.id))}),(0,u.default)((0,c.default)(l),"handleSendMessageCTA",function(t,e,n,a,o){t.preventDefault();t=l.props.agentMessages,a=[{action:"event_id",param:a.id},{action:"event_type",param:"firstInteraction-chat"},{action:"cta_type",param:a.ctaType},{action:"activated_button",param:null!==o},{action:"event",param:"click_send_message"},{action:"group",param:a.message}];(0,m.interactionWithUser)(t)||((0,g.setEventAnalytics)(n.user.id,n.app.id,window.navigator.userAgent,a),window[_.KEY__SDK]._onFirstInteraction&&window[_.KEY__SDK]._onFirstInteraction("click_send_message")),l.setState({closedComponent:!0}),l.props.dispatch((0,d.setConfig)({_showCTAButtons:!1})),e((0,d.openWindow)())}),l.state={closedComponent:!1},l}return(0,i.default)(n,[{key:"render",value:function(){var n=this,t=this.props,a=t.dispatch,e=t.dimensions,o=t.colors,i=t.classPosition,c=t.ctaButtonsData,s=t.agentConfig,r=c.complements,l=s,u=this.state.closedComponent,d=l._showCTAButtons,t=this.calculateMargin(i),s="top"===t?e.height:0,e="bottom"===t?e.height:0;return u&&!d||null===c.message&&null===r?null:p.default.createElement("div",{className:"cta-buttons__notification-container \n            cta-buttons__notification__".concat(i),style:{marginTop:"".concat(s,"px"),marginBottom:"".concat(e,"px")}},null!==c.message&&(0,m.isSmallWindow)()||!(0,m.isSmallWindow)()?p.default.createElement("div",{className:"cta-buttons__notification-container-close"},p.default.createElement("i",{style:{background:o[0]},className:"material-icons",onClick:function(t){return n.handleCloseCTAButtons(t,l,c,r)}},"close")):null,null!==c.message?p.default.createElement("div",{onClick:function(t){return n.handleSendMessageCTA(t,a,l,c,r)},className:"cta-buttons__notification-container-message"},p.default.createElement("h4",null,c.message)):null,null===r||(0,m.isSmallWindow)()?null:p.default.createElement("div",{className:"cta-buttons__notification-container-buttons"},r.map(function(e){return p.default.createElement("div",{className:"cta-buttons__notification-container-buttons-element",key:e.name},p.default.createElement("button",{style:{background:o[0]},onClick:function(t){return n.handleSendButtonCTA(t,a,l,e.name,e.intention,c,r)}},e.name))})))}}]),n}(p.default.Component);(e.CTAButtons=n).propTypes={dispatch:f.default.func,colors:f.default.array,classPosition:f.default.string,ctaButtonsData:f.default.object,dimensions:f.default.object,agentConfig:f.default.object,agentMessages:f.default.array}}}]);